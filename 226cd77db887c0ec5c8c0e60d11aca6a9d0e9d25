{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "860e695f_24a6cfc2",
        "filename": "plays/upgrade.yml",
        "patchSetId": 19
      },
      "lineNbr": 94,
      "author": {
        "id": 648
      },
      "writtenOn": "2021-07-01T19:48:34Z",
      "side": 1,
      "message": "Don\u0027t comment out lines, just remove them",
      "revId": "226cd77db887c0ec5c8c0e60d11aca6a9d0e9d25",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "3672b84e_faced550",
        "filename": "plays/upgrade.yml",
        "patchSetId": 19
      },
      "lineNbr": 94,
      "author": {
        "id": 789
      },
      "writtenOn": "2022-01-19T11:44:52Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "860e695f_24a6cfc2",
      "revId": "226cd77db887c0ec5c8c0e60d11aca6a9d0e9d25",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ea419714_402f5004",
        "filename": "plays/upgrade.yml",
        "patchSetId": 19
      },
      "lineNbr": 99,
      "author": {
        "id": 648
      },
      "writtenOn": "2021-07-01T19:48:34Z",
      "side": 1,
      "message": "I think this isn\u0027t necessary, this task is purely a replacement for a \"sleep 5\" that used to be here somewhere. All this does is \"wait for the upgrade process to start so we can start monitoring in the next task\".\nI would leave this alone as is, the `--for\u003dcondition\u003dProgressing` is doing exactly what you\u0027re doing here traversing the JSON",
      "revId": "226cd77db887c0ec5c8c0e60d11aca6a9d0e9d25",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "453912cd_26e16a10",
        "filename": "plays/upgrade.yml",
        "patchSetId": 19
      },
      "lineNbr": 99,
      "author": {
        "id": 789
      },
      "writtenOn": "2021-07-05T12:24:35Z",
      "side": 1,
      "message": "I had to update this task because of the condition I was setting on the next one.\n\nThe problem one, on some test execution I saw the Progressing condition transitioning to True and then the Failing condition doing the same immediately while retrieve some data on the upgrade path. The Failing condition would get solved on its own, I gues on retrying, and just after that the message in the Progressing condition would change to \"Moving towards {{ version }}\".\n\nThe goal of this CR is to develop a way to detect a permanent error in the upgrade process without having to rely on the monitor (next task) timeout, so that\u0027s why I also started monitoring the Failing condition (see my comment on the next task).",
      "parentUuid": "ea419714_402f5004",
      "revId": "226cd77db887c0ec5c8c0e60d11aca6a9d0e9d25",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d5e83bff_efc63f9e",
        "filename": "plays/upgrade.yml",
        "patchSetId": 19
      },
      "lineNbr": 99,
      "author": {
        "id": 789
      },
      "writtenOn": "2022-01-19T11:44:52Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "453912cd_26e16a10",
      "revId": "226cd77db887c0ec5c8c0e60d11aca6a9d0e9d25",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e3c06925_878113e9",
        "filename": "plays/upgrade.yml",
        "patchSetId": 19
      },
      "lineNbr": 113,
      "author": {
        "id": 648
      },
      "writtenOn": "2021-07-01T19:48:34Z",
      "side": 1,
      "message": "As I understand it this allows you to fail quicker if a problem is detected instead of waiting for the retry loop to exit, but it becomes a bit unreadable.\n\nI suggest start by using the k8s_info module (it wasn\u0027t available back when this was written) and start from there. Keep simpler `until` and `failed_when` conditions for the loop.\n\nKeep in mind that the whole upgrade process is done in a reconciliation loop, so it is entirely possible for the status to reach a \"Failing\" status before retrying.",
      "revId": "226cd77db887c0ec5c8c0e60d11aca6a9d0e9d25",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2cdbf38a_e4b47c9a",
        "filename": "plays/upgrade.yml",
        "patchSetId": 19
      },
      "lineNbr": 113,
      "author": {
        "id": 789
      },
      "writtenOn": "2021-07-05T12:32:22Z",
      "side": 1,
      "message": "Using k8s_info module seems like the right way to go. Thanks.\n\nRegarding the upgrade retry loop I\u0027m having the following problem. As explained above, the idea of the CR was to provide the agent with a mean to fast getting out of the Monitor task in the event of a failure. The problem I\u0027m experiencing is the cluster version may activate the Failing condition due to a failure, and then disable the condition a few minutes later as it retries to upgrade the components (I guess this is what you mean by the reconciliation loop). So, as far as I can tell, openshift will retry upgrading itself once and again so the actual only possible condition for a failure on the upgrade would be that the monitor times out. It\u0027s either that or we find a way to keep a counter on the failures and set a maximum retry attempts.",
      "parentUuid": "e3c06925_878113e9",
      "revId": "226cd77db887c0ec5c8c0e60d11aca6a9d0e9d25",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "2fc5e673_f71a55cd",
        "filename": "plays/upgrade.yml",
        "patchSetId": 19
      },
      "lineNbr": 113,
      "author": {
        "id": 789
      },
      "writtenOn": "2022-01-19T11:44:52Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "2cdbf38a_e4b47c9a",
      "revId": "226cd77db887c0ec5c8c0e60d11aca6a9d0e9d25",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    }
  ]
}