{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "408ca75d_78fba443",
        "filename": "plays/upgrade-csv.yml",
        "patchSetId": 2
      },
      "lineNbr": 64,
      "author": {
        "id": 938
      },
      "writtenOn": "2022-09-14T14:20:18Z",
      "side": 1,
      "message": "Hi Nacho, is it guaranteed that the ocp_version channel will always be present? I remember an issue in the past when operators were unavailable for the latest OCP versions.",
      "revId": "0952f7c69791bfc50dd736dbcc5efc16ef30b5f3",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c8279ec3_c01b0daa",
        "filename": "plays/upgrade-csv.yml",
        "patchSetId": 2
      },
      "lineNbr": 64,
      "author": {
        "id": 673
      },
      "writtenOn": "2022-09-14T14:45:21Z",
      "side": 1,
      "message": "I agree. I remember we removed this field and let it blank so it will get the default channel.",
      "parentUuid": "408ca75d_78fba443",
      "revId": "0952f7c69791bfc50dd736dbcc5efc16ef30b5f3",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "abce05d8_ce5133fc",
        "filename": "plays/upgrade-csv.yml",
        "patchSetId": 2
      },
      "lineNbr": 64,
      "author": {
        "id": 938
      },
      "writtenOn": "2022-09-14T15:05:01Z",
      "side": 1,
      "message": "We could first check if the channel is here, and if not, use the default one.",
      "parentUuid": "c8279ec3_c01b0daa",
      "revId": "0952f7c69791bfc50dd736dbcc5efc16ef30b5f3",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f31f7959_7df78b98",
        "filename": "plays/upgrade-csv.yml",
        "patchSetId": 2
      },
      "lineNbr": 64,
      "author": {
        "id": 724
      },
      "writtenOn": "2022-09-14T15:13:59Z",
      "side": 1,
      "message": "Good catch, but unfortunately ocp_version may not be a good fit for this. \n\nDuring the installation, we are inspecting the package to detect the default channel and assign it explicitly to the subscription. https://github.com/redhat-cip/dci-openshift-agent/blob/ccdc8a449101993bd058848d5ec8aa5bcd696f6f/common-roles/olm-operator/tasks/main.yml#L43 \n\nHere we should do the same, inspect the packagemanifest and obtain the new channel (we already do that for the new target CSV).\n\n$ oc get subs -A -o\u003dcustom-columns\u003dNAME:.metadata.name,CHANNEL:.spec.channel\nNAME                                                                              CHANNEL\nkubevirt-hyperconverged                                                           stable\ncluster-logging                                                                   stable\nmtc-operator                                                                      release-v1.7\nredhat-oadp-operator-stable-1.0-mirrored-redhat-operators-openshift-marketplace   stable-1.0\nelasticsearch-operator                                                            stable\nperformance-addon-operator                                                        4.10\nsriov-network-operator                                                            stable",
      "parentUuid": "c8279ec3_c01b0daa",
      "revId": "0952f7c69791bfc50dd736dbcc5efc16ef30b5f3",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "8005e3e5_8360bd34",
        "filename": "plays/upgrade-csv.yml",
        "patchSetId": 2
      },
      "lineNbr": 64,
      "author": {
        "id": 724
      },
      "writtenOn": "2022-09-15T04:23:07Z",
      "side": 1,
      "message": "Actually, we get the new channel in here in line 17.",
      "parentUuid": "f31f7959_7df78b98",
      "revId": "0952f7c69791bfc50dd736dbcc5efc16ef30b5f3",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d0472b1a_e0bca5b5",
        "filename": "plays/upgrade-csv.yml",
        "patchSetId": 2
      },
      "lineNbr": 64,
      "author": {
        "id": 938
      },
      "writtenOn": "2022-09-15T08:02:52Z",
      "side": 1,
      "message": "Thanks for the explanation Beto, so the idea is to replace `ocp_version` with `default_channel`?",
      "parentUuid": "8005e3e5_8360bd34",
      "revId": "0952f7c69791bfc50dd736dbcc5efc16ef30b5f3",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    }
  ]
}