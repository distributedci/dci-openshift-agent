---
- name: Create hosts inventory file
  hosts: provisioner
  become: true
  tasks:
    - name: Generating hosts inventory file
      template:
        src: ./templates/hosts.j2
        dest: "{{ inventory_prefix }}hosts"
      vars:
        input_prefix: "{{ lookup('env', 'PREFIX') }}"
        inventory_prefix: "{{ (input_prefix | replace('-p ', '')) + '-' if input_prefix != '' else '' }}"
      delegate_to: localhost
    - name: Create cache_dir_base Directory
      file:
        path: "{{ cache_dir_base }}"
        state: directory
        mode: '0755'
