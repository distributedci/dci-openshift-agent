---
- name: Check the variables needed to install ISO on SUTs
  fail:
    msg: "variable {{ item }} not defined"
  when: item is not defined
  with_items:
    - _suts

- name: Install ISO on SUTs
  include_role:
    name: redhatci.ocp.install_iso
  vars:
    boot_iso_url: http://localhost:80/microshift.iso
    target_host: "{{ item.name }}"
    bmc_address: "{{ sushy_tools_bmc_address }}"
    bmc_user: "{{ sushy_tools_bmc_user }}"
    bmc_password: "{{ sushy_tools_bmc_password }}"
  with_items: "{{ _suts }}"
