---

- name: "Remove ACM temp pull secret"
  file:
    path: "{{ dci_pullsecret_file }}"
    state: absent
  when:
    - dci_pullsecret_file is defined
    - install_type == 'acm'

- name: "Remove the job directory"
  file:
    path: "{{ job_dir.path }}"
    state: absent
  when: job_dir.path is defined

- name: "Remove docker auths directory"
  file:
    path: "{{ docker_conf.path }}"
    state: absent
  when: docker_conf is defined

- name: "Teardown for storage service tester"
  include_role:
    name: storage-tester
    tasks_from: teardown.yml
    apply:
      environment:
        KUBECONFIG: "{{ kubeconfig_path }}"
        REGISTRY: "{% if dci_disconnected | default(false) %} {{ local_registry_host | default('') }}:{{ local_registry_port | default('') }} {% else %}registry.redhat.io{% endif %}"
        OC_PATH: "{{ oc_tool_path }}"
  when:
    - dci_main is defined
    - dci_main == 'upgrade'
    - storage_upgrade_tester | default(false) | bool
...