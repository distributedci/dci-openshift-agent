---
- name: Check on the EPEL repository status on a connected provisioner
  become: true
  yum:
    name: epel-release
  when: not (dci_disconnected | default(false) | bool)

- name: Configure extra repositories
  become: true
  yum_repository:
    name: "{{ item.name }}"
    description: "{{ item.description | default(item.name + ' repository') }}"
    baseurl: "{{ item.baseurl }}"
    mirrorlist: "{{ item.mirrorlist | default(omit) }}"
    gpgcheck: "{{ item.gpgcheck | default('no') }}"
    state: "{{ item.state | default('present') }}"
  with_items: "{{ provisioner_extra_repos | default([]) }}"

- name: Install packages
  become: true
  package:
    name:
      - "python{% if ansible_python.version.major == 3 %}3{% endif %}-openshift"
    state: installed

- name: "Install python3-crypto from alternate repo"
  yum:
    name: "https://trunk.rdoproject.org/rhel8-master/deps/latest/Packages/python3-crypto-2.6.1-18.el8ost.x86_64.rpm"
    state: present
    disable_gpg_check: yes
  become: true
...
