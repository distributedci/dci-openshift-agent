{
  "comments": [
    {
      "key": {
        "uuid": "da4c756d_0d138e77",
        "filename": "roles/mirror-ocp-release/tasks/images.yml",
        "patchSetId": 7
      },
      "lineNbr": 19,
      "author": {
        "id": 667
      },
      "writtenOn": "2021-11-10T18:22:15Z",
      "side": 1,
      "message": "Could you make this match the condition below, i.e. [\u003c 4.8]",
      "revId": "72b3d27648f780fc172ae83d7e07dc85915e08f2",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "23240e18_b3b7c7a8",
        "filename": "roles/mirror-ocp-release/tasks/images.yml",
        "patchSetId": 7
      },
      "lineNbr": 19,
      "author": {
        "id": 789
      },
      "writtenOn": "2021-11-11T10:44:18Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "da4c756d_0d138e77",
      "revId": "72b3d27648f780fc172ae83d7e07dc85915e08f2",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "2269f2ec_8324e429",
        "filename": "roles/mirror-ocp-release/tasks/images.yml",
        "patchSetId": 7
      },
      "lineNbr": 36,
      "author": {
        "id": 667
      },
      "writtenOn": "2021-11-10T18:22:15Z",
      "side": 1,
      "message": "Can you add that this is for [\u003e\u003d 4.8]",
      "revId": "72b3d27648f780fc172ae83d7e07dc85915e08f2",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4e64504e_2ea702a3",
        "filename": "roles/mirror-ocp-release/tasks/images.yml",
        "patchSetId": 7
      },
      "lineNbr": 36,
      "author": {
        "id": 789
      },
      "writtenOn": "2021-11-11T10:44:18Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "2269f2ec_8324e429",
      "revId": "72b3d27648f780fc172ae83d7e07dc85915e08f2",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5836db64_1304f528",
        "filename": "roles/mirror-ocp-release/tasks/images.yml",
        "patchSetId": 7
      },
      "lineNbr": 66,
      "author": {
        "id": 667
      },
      "writtenOn": "2021-11-10T18:22:15Z",
      "side": 1,
      "message": "The replace of double-quotes is not needed, basename is able to handle the trimming just right",
      "revId": "72b3d27648f780fc172ae83d7e07dc85915e08f2",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4f6efbdb_731ddb78",
        "filename": "roles/mirror-ocp-release/tasks/images.yml",
        "patchSetId": 7
      },
      "lineNbr": 66,
      "author": {
        "id": 789
      },
      "writtenOn": "2021-11-11T10:44:18Z",
      "side": 1,
      "message": "Thanks for the suggestion. I didn\u0027t know that. I\u0027ll try removing the replacement, although I have some concerns on the final effect of this. Let\u0027s see if it passes the checks.",
      "parentUuid": "5836db64_1304f528",
      "revId": "72b3d27648f780fc172ae83d7e07dc85915e08f2",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8a8ea8cf_567020d1",
        "filename": "roles/mirror-ocp-release/tasks/images.yml",
        "patchSetId": 7
      },
      "lineNbr": 66,
      "author": {
        "id": 667
      },
      "writtenOn": "2021-11-11T17:20:32Z",
      "side": 1,
      "message": "The end result is the same ðŸ˜Š",
      "parentUuid": "4f6efbdb_731ddb78",
      "revId": "72b3d27648f780fc172ae83d7e07dc85915e08f2",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "dbd60acd_3eb2754b",
        "filename": "roles/mirror-ocp-release/tasks/images.yml",
        "patchSetId": 7
      },
      "lineNbr": 125,
      "author": {
        "id": 667
      },
      "writtenOn": "2021-11-10T18:22:15Z",
      "side": 1,
      "message": "The comment is not clear on what sha is going to be used at the end as I see it is still using uncompressed.\n\nRegardless, I don\u0027t think those SHAs are used at all ðŸ˜„ \n\nI did not see anything special on the webserver that hosts the images, I have the impression that the sha256 argument is completely ignored, see:\n\n$ curl -i -D - -so /dev/null http://jumphost.cluster6.dfwt5g.lab:8080/rhcos-48.84.202109241901-0-qemu.x86_64.qcow2.gz?sha256\u003dfakedata\nHTTP/1.1 200 OK\nDate: Wed, 10 Nov 2021 18:19:37 GMT\nServer: Apache/2.4.34 (Red Hat) OpenSSL/1.0.2k-fips\nLast-Modified: Thu, 07 Oct 2021 03:28:51 GMT\nETag: \"3cb2a505-5cdbadc88d993\"\nAccept-Ranges: bytes\nContent-Length: 1018340613\nContent-Type: application/x-gzip\n\n$ curl -i -D - -so /dev/null http://jumphost.cluster6.dfwt5g.lab:8080/rhcos-48.84.202109241901-0-qemu.x86_64.qcow2.gz?sha256\u003d0105a1de918e94e9c456f32dac63e3cf296efa0b59f543fc23c1ef00ebb15a5f                                                                  \nHTTP/1.1 200 OK\nDate: Wed, 10 Nov 2021 18:19:43 GMT\nServer: Apache/2.4.34 (Red Hat) OpenSSL/1.0.2k-fips\nLast-Modified: Thu, 07 Oct 2021 03:28:51 GMT\nETag: \"3cb2a505-5cdbadc88d993\"\nAccept-Ranges: bytes\nContent-Length: 1018340613\nContent-Type: application/x-gzip\n\nRemove it and give it a try, I think it will not make a difference and luckily we can get rid of that additional uncompressed variable.",
      "revId": "72b3d27648f780fc172ae83d7e07dc85915e08f2",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6758d5f3_08a28115",
        "filename": "roles/mirror-ocp-release/tasks/images.yml",
        "patchSetId": 7
      },
      "lineNbr": 125,
      "author": {
        "id": 789
      },
      "writtenOn": "2021-11-11T10:44:18Z",
      "side": 1,
      "message": "I see. I was trying to reproduce the operations for versions 4.7-. Right now I removed the usage of uncompressed-sha256 in favor of plain sha256. Do you think in could be removed for good, or shall we keep it in case it\u0027s needed in the future?",
      "parentUuid": "dbd60acd_3eb2754b",
      "revId": "72b3d27648f780fc172ae83d7e07dc85915e08f2",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0d29a0d9_62c542ac",
        "filename": "roles/mirror-ocp-release/tasks/images.yml",
        "patchSetId": 7
      },
      "lineNbr": 125,
      "author": {
        "id": 667
      },
      "writtenOn": "2021-11-11T17:20:32Z",
      "side": 1,
      "message": "It does not seem to take any effect at all. My test shows that regardless of the variable you get the same file.\n\nDropping the arg should be good too, see:\n\n$ curl -i -D - -so /dev/null http://jumphost.cluster6.dfwt5g.lab:8080/rhcos-48.84.202109241901-0qemu.x86_64.qcow2.gz\nHTTP/1.1 200 OK\nDate: Thu, 11 Nov 2021 17:18:32 GMT\nServer: Apache/2.4.34 (Red Hat) OpenSSL/1.0.2k-fips\nLast-Modified: Thu, 07 Oct 2021 03:28:51 GMT\nETag: \"3cb2a505-5cdbadc88d993\"\nAccept-Ranges: bytes\nContent-Length: 1018340613\nContent-Type: application/x-gzip",
      "parentUuid": "6758d5f3_08a28115",
      "revId": "72b3d27648f780fc172ae83d7e07dc85915e08f2",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "13114d0d_09f66ce4",
        "filename": "roles/mirror-ocp-release/tasks/images.yml",
        "patchSetId": 7
      },
      "lineNbr": 125,
      "author": {
        "id": 648
      },
      "writtenOn": "2021-11-11T20:19:22Z",
      "side": 1,
      "message": "I think the SHA is used to verify the downloaded QEMU image later down the road?",
      "parentUuid": "0d29a0d9_62c542ac",
      "revId": "72b3d27648f780fc172ae83d7e07dc85915e08f2",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2223bb3a_40622949",
        "filename": "roles/mirror-ocp-release/tasks/images.yml",
        "patchSetId": 7
      },
      "lineNbr": 125,
      "author": {
        "id": 667
      },
      "writtenOn": "2021-11-11T21:34:18Z",
      "side": 1,
      "message": "It is, but earlier, on line 89. After that the SHA is of no use ðŸ˜†",
      "parentUuid": "13114d0d_09f66ce4",
      "revId": "72b3d27648f780fc172ae83d7e07dc85915e08f2",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "eb8792ce_200e9e2d",
        "filename": "roles/mirror-ocp-release/tasks/images.yml",
        "patchSetId": 7
      },
      "lineNbr": 125,
      "author": {
        "id": 789
      },
      "writtenOn": "2021-11-12T09:26:28Z",
      "side": 1,
      "message": "Yes. But what annoyed me the most, is that here we had the uncompressed sha256, but we were working with the gzipped image. This gave me the first clue it might not be needed at all in this step.",
      "parentUuid": "2223bb3a_40622949",
      "revId": "72b3d27648f780fc172ae83d7e07dc85915e08f2",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6f9ce1c1_2e5c5e7f",
        "filename": "roles/mirror-ocp-release/tasks/images.yml",
        "patchSetId": 7
      },
      "lineNbr": 125,
      "author": {
        "id": 789
      },
      "writtenOn": "2021-11-12T11:45:49Z",
      "side": 1,
      "message": "As it turns out, I just found out why the uncompressed-sha256 is needed.\nApparently, in versions prior to 4.8, the download process of the qemu image is as follows:\n- image is downloaded\n- image is uncompressed\n- uncompressed image sha is verified\nAnd the installer takes the sha value from the URL.\nI added a comment in the code to clarify using uncompressed-sha in the url is not a mistake for future contributors.",
      "parentUuid": "eb8792ce_200e9e2d",
      "revId": "72b3d27648f780fc172ae83d7e07dc85915e08f2",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8a94c481_48208a4e",
        "filename": "roles/mirror-ocp-release/tasks/images.yml",
        "patchSetId": 7
      },
      "lineNbr": 125,
      "author": {
        "id": 667
      },
      "writtenOn": "2021-11-12T16:28:36Z",
      "side": 1,
      "message": "Ah! now it makes sense, thanks for digging into it!",
      "parentUuid": "6f9ce1c1_2e5c5e7f",
      "revId": "72b3d27648f780fc172ae83d7e07dc85915e08f2",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0",
      "unresolved": false
    }
  ]
}