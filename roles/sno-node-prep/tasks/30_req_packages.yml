---
- name: "Install required packages"
  yum:
    name: "{{ package_list }}"
    state: present
    update_cache: true
    disable_gpg_check: yes
  become: yes
  tags: packages

- name: "Install specific packages for SNO virtual"
  yum:
    name: "{{ item }}"
    state: present
    disable_gpg_check: yes
  become: yes
  loop:
    - libvirt
    - qemu-kvm
    - virt-install
  when: |
    - (sno_install_type is undefined) or
      (sno_install_type == virtual)
  tags: packages

- name: "Install specific packages for SNO baremetal"
  yum:
    name: "{{ item }}"
    state: present
    disable_gpg_check: yes
  become: yes
  loop:
    - dnsmasq
    - httpd
  when: 
    - sno_install_type is defined
    - sno_install_type == baremetal
  tags: packages
