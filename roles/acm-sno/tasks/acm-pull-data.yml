---
- name: "Get cluster user-ca cert if exists"
  community.kubernetes.k8s_info:
    api: v1
    kind: ConfigMap
    name: "user-ca-bundle"
    namespace: openshift-config
  register: user_ca_bundle

- name: "Get the user_ca_bundle content"
  set_fact:
    acm_user_ca_bundle: '{{ acm_user_bundle | default(user_ca_bundle.resources[0].data["ca-bundle.crt"]) }}'
  when:
    - user_bundle is defined or
      user_ca_bundle.resources | length == 1

- name: "Get hub cluster pull_secret details"
  community.kubernetes.k8s_info:
    api: v1
    kind: Secret
    name: "pull-secret"
    namespace: openshift-config
  register: acm_pull_secret

- name: "Setting config facts based on Hub Cluster configs"
  set_fact:
    acm_ssh_key: "{{ worker_mc.resources[0].spec.config.passwd.users[0].sshAuthorizedKeys[0] }}"
    acm_pull_secret: '{{ acm_pull_secret.resources[0].data[".dockerconfigjson"] }}'
...
