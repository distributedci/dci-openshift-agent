---
- name: "Create SriovNetworkNodePolicy for {{ sriov['policy'] }}"
  k8s:
    definition: "{{ lookup('template', 'sriov-policy.yaml.j2') }}"

- name: "Create SriovNetworkTargetNamespace {{ sriov['target_namespace'] }}"
  k8s:
    api: v1
    kind: Namespace
    name: "{{ sriov['target_namespace'] }}"
  when:
    - sriov['target_namespace'] is defined
    - sriov['target_namespace'] | length != 0

- name: "Create SriovNetwork for {{ sriov['name'] }}"
  k8s:
    definition: "{{ lookup('template', 'sriov-network.yaml.j2') }}"
  when:
    - sriov['name'] is defined and sriov['name'] | length != 0
    - sriov['vlan'] is defined and sriov['vlan'] > 0
...
